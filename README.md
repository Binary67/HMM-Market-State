# HMM Trading Demonstration

This project demonstrates a simple application of Hidden Markov Models (HMMs) for identifying potential market regimes or states from historical stock price data. It includes functionalities to download financial data using `yfinance` and then apply an HMM to discern patterns.

## Project Structure

- `requirements.txt`: Lists the Python dependencies required for this project.
- `Main.py`: The main script to run the demonstration. It fetches data, trains the HMM, predicts states, and plots the results.
- `HmmTrading/`: Directory containing the core logic.
    - `DataDownloader.py`: Contains the `YahooFinanceDownloader` class for fetching historical stock data from Yahoo Finance.
    - `HmmModel.py`: Contains the `TradingHmm` class, which implements the Hidden Markov Model. This class handles data preprocessing (calculating log returns and volatility), training the HMM, predicting hidden states.
- `AAPL_Hmm_Trading_Analysis.png`: Example plot generated by running `Main.py` with default parameters. (This file will be generated when you run the script).

## Concept: HMM in Trading

Hidden Markov Models (HMMs) are statistical models where the system being modeled is assumed to be a Markov process with unobserved (hidden) states. In trading, these hidden states can be interpreted as different market regimes, such as:

- **Bullish:** A state of generally rising prices.
- **Bearish:** A state of generally falling prices.
- **Sideways/Neutral:** A state of low volatility or no clear trend.

The model learns transition probabilities between these states and the observation likelihoods (e.g., patterns in price returns and volatility) associated with each state from historical data. Once trained, the HMM can predict the sequence of hidden states for new data, potentially offering insights into current market conditions.

This demonstration uses daily log returns and rolling volatility as features to train the HMM. The number of hidden states is configurable.

**Disclaimer:** This is a simplified demonstration for educational purposes and should not be considered financial advice or a production-ready trading system. Real-world trading involves significant risk and requires more sophisticated models and risk management strategies.

## Setup and Installation

1.  **Clone the repository (if you haven't already):**
    ```bash
    git clone <repository_url>
    cd <repository_directory>
    ```

2.  **Create a virtual environment (recommended):**
    ```bash
    python -m venv venv
    source venv/bin/activate  # On Windows use `venv\Scripts\activate`
    ```

3.  **Install dependencies:**
    Make sure you have Python 3.8+ installed. Then, install the required packages using `requirements.txt`:
    ```bash
    pip install -r requirements.txt
    ```

## How to Run

Execute the `Main.py` script from the root directory of the project:

```bash
python Main.py
```

This will:
1. Download historical stock data for the ticker specified in `Main.py` (default is 'AAPL').
2. Preprocess the data to extract features (log returns, volatility).
3. Train a Gaussian HMM with a specified number of hidden states.
4. Predict the sequence of hidden market states.
5. Generate and save a plot (`<TICKER_SYMBOL>_Hmm_Trading_Analysis.png`) showing the stock's closing price with the identified HMM states overlaid, and a separate plot of the hidden state sequence.

You can modify `TickerSymbol`, `StartDate`, `EndDate`, and `NumberOfHiddenStates` in `Main.py` to experiment with different stocks, time periods, and model configurations.

## Running the Streamlit Application

To run the interactive Streamlit application:

1. Ensure you have all necessary dependencies installed:
   ```bash
   pip install -r requirements.txt
   ```
2. Navigate to the root directory of the project in your terminal.
3. Run the following command:
   ```bash
   streamlit run StreamlitApp.py
   ```
This will open the application in your web browser.
